\documentclass[../main.tex]{subfiles}
\begin{document}

We evaluate popular open-source honeypots with the proposed classification. We try to fingerprint the honeypots by harnessing the methods. The honeypots under evaluation are from the Honeynet Project. The evaluation involves setting up of all the honeypots on a public internet facing system. Each honeypot is targeted with both low and high effort techniques. 
 
\subsection{Low-effort Honeypot Fingerprinting Techniques}
 We subject the honeypots to the low-effort fingerprinting method. The data retrieved is then used to infer the existence of a honeypot. We propose three approaches for the evaluation of low-effort fingerprinting techniques. The first approach involves searching Shodan and Censys for the IP address of the target system. The second approach involves searching for vulnerable services exposed to the internet through Shodan and determining if the target system is a honeypot. The last approach involves using keyword searches in search engines(Shodan and Censys). We use the metadata obtained from the search results to fingerprint the honeypots. 
 
 \subsubsection{IP address Search}
The IP address of the suspected target system is used as a search parameter to determine the open ports, services, geo-location, hostname, and the hosting provider. By correlating the data obtained from the search results it is possible to infer the presence of a honeypot. For example, if the IP address does not resolve to a domain name with, the port 500 open and is hosted on a cloud, the system is likely a honeypot. This is because port 500 is used for the MODBUS protocol for network communication in Industrial Control Systems. It is very unlikely to have ICS systems hosted on the cloud as they are physical systems that are deployed in industrial environments.  Further derivations can be made based on the location of the system. If the system is located to be not in an enterprise, but to a common household or an education research facility, we can infer that the target system is a honeypot. We  evaluate the popular honeypots with the IP based low effort fingerprinting and present the results in Table \ref{Tab:IP address}

 \subsubsection{Vulnerable services Search}
 Vulnerable services can be retrieved by providing the name of a service as a search parameter in Shodan or Censys. The results listed can then be examined for IP address, location, hosting provider, encryption algorithms and content. For example, providing SSH as a search parameter, we obtain many search results. SSH is a preferred protocol for communicating with cloud instances and remote systems. Based on the header information, list of encryption algorithms, protocol version and comparing the data with response from an actual honeypot, it is possible to infer that the system is a honeypot. The majority of the open-source honeypot implementations depend on poorly maintained libraries. These libraries emulate static responses for handshake and session creation. By comparing the response data from the honeypots and verifying the similarities it can be confirmed that the system is a honeypot. 
 
 \subsubsection{Keyword based Search}
The keyword-based search involves searching the Shodan and Censys database for specific content concerning honeypots. This content must be specific to the implementation of honeypots. The keywords may also just include the name of the honeypots as the search parameter. Often, honeypots are deployed with their default configuration and content. This static content can be used as a search parameter. For example, Conpot an ICS honeypot has the default static web content with the keyword "Technodrome" on it. Shodan and Censys search determined many results based on this keyword. Glastopf, an open-source HTTP honeypot has "<h2>My Resource</h2>" as header content on its web page. Using this as a search parameter exposed around 102 honeypots online. We find similar keywords that exposed many popular open-source honeypots. We list the honeypots that could be identified in Table \ref{Tab:IP address}

 \begin{table}[]
 \begin{tabular}{ |p{1.5cm}||p{1.5cm}||p{1.2cm}|p{1.4cm}| }
 \hline
 \multicolumn{4}{|c|}{Low-effort Honeypot Fingerprinting Techniques} \\
 \hline
 Honeypots & IP Address Search & Vulnerable Services Search & Keyword Search \\
 \hline
 Kippo   & *  &* & *  \\
 Cowrie  & *  &* & *  \\
 Glastopf& *  &* & *  \\
 Dionaea & *  &* & *  \\
 Conpot  & *  &* & *  \\
 HostaGe & *  &*  &  *  \\
 \hline
\end{tabular}
 \caption{Evaluation of Honeypots based on IP address Low-Effort Fingerprinting Methods}
 \label{Tab:IP address}
 \end{table}


\subsection{High-effort Honeypot Fingerprinting Techniques}
High-effort Honeypot fingerprinting techniques involve direct interaction with the target systems. The methods all probe-based techniques. They are classified as high effort as multiple probe-based techniques are used to obtain specific data about the target system by directly interacting with it. They provide higher detection accuracy than the low effort because of specific information obtained from the probes. Definite models can be constructed based on the probes and the data received from these methods. Further, these models can be used to develop machine learning-based systems based on the data received from the initial probes. We evaluate honeypots based on the probe-based fingerprinting methods for their detection using Banner based probing, deep packet inspection, and command execution.

\subsubsection{Banner based Probing}
Banner based probing involves starting a communication channel with the target system and checking the banner response advertised from the service for anomalies. The deviation in default banners provided by standard services gives information about the system. On looking up the banner response and comparing it with the standard banners, it can be inferred that the target system is a honeypot. Normally, honeypot administrators forget to change the banner response parameters based on the operating system the service is running. If there is a mismatch on the information from the banner to that of the underlying system, it is evident that the system is a honeypot. Both Shodan and Censys provide banners for systems open to the internet. However, this information cannot be found if detecting honeypots on a local network. Popular services that advertise banners include FTP, SSH, HTTP, MODBUS, VNC, and HTTPS. 


\subsubsection{Command Execution}
Honeypots emulate the services of a real system. These emulations do not emulate all the functionality of a service. Low-interaction honeypots are designed to provide an emulation similar to the real system that only encourages an attacker to establish a connection. Further probing of the system with specific commands based on the operating system and the network protocol result in unexpected responses that infer that the system is a honeypot. Command execution provides the highest detection accuracy for fingerprinting honeypots. A series of commands can be executed in the target system and checking the response helps in characterizing the system as a honeypot. 



\subsubsection{Deep Packet Inspection}
Deep packet inspection(DPI) provides comprehensive information about the protocol implementation in the system. It involves capturing the network communication between the attacker and the honeypot and inspecting the packet dump obtained for anomalies in the responses. DPI is a very effective fingerprinting technique that can classify the end system based on transport layer protocol responses, response times, operating systems and packet payload. We use the above probe-based methods in conjunction with the other methods specified in subsection \ref{Probe Based}





\begin{tabular}{ |p{1.5cm}||p{1.5cm}|p{1.5cm}|p{1cm}| }
 \hline
 \multicolumn{4}{|c|}{High-Effort Honeypot Fingerprinting Techniques} \\
 \hline
 Honeypots & Banner Grabbing & Command Execution & DPI \\
 \hline
 Kippo   & *  &* & * \\
 Cowrie  & *  &* & * \\
 Glastopf& *  &* & *  \\
 Dionaea & *  &* & * \\
 Conpot  & *  &* & * \\
 HostaGe & *  &* & * \\
 \hline
\end{tabular}
\end{document}
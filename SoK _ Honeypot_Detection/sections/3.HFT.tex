\section{Honeypot Fingerprinting Techniques}
\label{sec:hft}

Based on background research, there has been research in the area of network, OS and application fingerprinting. In this section, we present an overview of different Honeypot Fingerprinting techniques. 

\subsection{Geo-Location}
The location of a system determines what sector it is being used. It is possible to accurately determine the location of any system bearing a public \acrshort{ip} address. This information is particularly useful when the system is suspected to be in a location that is not relevant to the services it is offering. This information can be used to derive that the target is either a training system or a honeypot. 

\subsection{\acrfull{isp}}
With the \acrshort{ip} address information, it is possible to find the \acrshort{isp} that the address pool belongs to. This is especially useful in deriving information about the service providers to industries and corporate environments. Normally, enterprises have dedicated leased lines or fiber lines from well-known service providers. Also, service providers may deploy many honeypots in their management networks as a proactive defense strategy. For example, if the \acrshort{ip} address is assigned to a hosting service like \acrshort{aws}, the \acrshort{isp} is listed as Amazon. This information can be used to infer that the system is a honeypot as Amazon is not a generic \acrshort{isp}. 

\subsection{Hosting Provider}
The hosting of the target system is good evidence of the implication of a honeypot. If the target is found to be hosted with a cloud provider, with pointless services, it is very conclusive that the target is a honeypot. Also, if the system is hosted with an unrelated domain pool that differs from the content of the honeypot, it can further lead to the inference of being a honeypot. It is very important for honeypot developers to create content and responses that relate to the hosting domain. 

\subsection{\acrshort{dns} / \acrfull{fqdn}}
Based on the fingerprinting results from Alexander et. al, we notice that a vast number of honeypots that were fingerprinted do not have a \acrfull{fqdn}. The reason is because the honeypots were deployed for either research purpose or for experimentation. Domain names have to be registered and must be purchased legally from a verified provider. Experimental setups and research setups are bind by budget restrictions and do not purchase a domain names. However, not having a domain name alone cannot be used as a fingerprinting technique but can be used as an additional metadata for inference. Presence of a valid domain name can further help in verifying the setup. For example, if the \acrshort{ip} address of the target systems that is a ssh server and has a no domain registry linked, we can verify that the system is not part of an organization. Corporate organizations have verified domains attached to their allocated \acrshort{ip} address range. 

\subsection{Shodan/Censys Passive Search}
Shodan is a database of vulnerable systems on the Internet. It provides search as a service by accepting \acrshort{ip} address, hostname or service names as search parameters. The output contains information about the target system and its open services. Shodan also provides a Honeypot Detection service called HoneyScore  in addition to the database of vulnerable systems \cite{SHODAN}. Shodan performs daily scans of the Internet with probe-based fingerprinting methods to identify vulnerable systems on the Internet. It has also a major source for attackers to get fast access to vulnerable systems. Though Shodan and Censys use active probing to detect and collect technical information about the target systems, we leverage the information stored in their repositories as metadata to determine if the target system is a honeypot. Similarly, Censys provides advanced querying of the data collected from the internet wide scan. 

Censys is another Internet-wide search engine that is similar to Shodan. It makes use of the ZGRAB  utility to collect application-level data of the services running on the target machine \cite{censys}. Censys also offers a query-able search based on the specific service running on the target system. Censys performs daily Internet-wide scans and aggregates the data in a query-able database. It differs from Shodan by providing a query-based search towards application-level data. Censys does not provide a honeypot detection service yet. Both Shodan and Censys provide reporting capabilities and offer \acrfull{api}. 

\subsection{Port Scanning}
Port scanning is the a technique to determine the open ports and services on the target system. It forms the first step before attacking a target system. Port scanning involves scanning and listing open ports on the target system. Ports that are open signify that they are open for communication and the active services on the system. Many administrators leave the services running on default ports and configuration. For example, port 22 is used for SSH and port 80 for HTTP web service. Port scanning provides information about the transport layer protocol used, the port number and the status of the port. Popular port scanning tools like NMap provide more information about the open ports like the active service, version and the vulnerabilities associated with the version \cite{NMap}. NMap also provides fast scans and detailed scans that recognizes six port states and classifies them into open, closed, filtered, unfiltered, open-filtered and closed-filtered. It has a database of fingerprinting information for 2000 services. 
Tools like NMap and ZMap provide parameterized scripts to run port scanning on target machines \cite{zmap}. Furthermore, custom scripts have been developed with NMap that can identify honeypots like Kippo and Dionaea.  

\subsection{Banner Grabbing}
Banner grabbing is one of the techniques used in the reconnaissance process following a port scan. After learning about the open ports, a connection is established with the remote system to get information about the service and the version number. Some implementations of protocols like FTP and HTTP expose critical system information like service name, software, version, and the operating system. Banner grabbing based probes targeted on a protocol can reveal vulnerabilities associated with any critical information obtained. The CVE database provides a list of vulnerabilities associated with protocols, software and operating systems  \cite{CVE}. Popular tools for Banner Grabbing are Wget\cite{wget}, cURL\cite{curl}, NMap\cite{NMap}, Netcat\cite{netcat}, and Dmitry\cite{dmitry}. Banner grabbing can be used not only for netfork fingerprinting, but also for application fingerprinting. Damron et. al  demonstrates that banner grabbing can be effectively used to fingerprint application software through requests \cite{bannergrab}. The author considers Apache Web Server as an example and presents distinct response codes from the banner that can be used fingerprinting. Alexander et. al  show that banner response from honeypots like Kippo showcase distinct values that can be used for fingerprinting the honeypot \cite{Vetterl2018}. Censys also provides a feature for querying the database with specific values in the banner response. Banner grabbing is also an integrated feature with port scanning on most of the port scanning tools. 

\subsection{Handshake Proposals}
\acrfull{tls} handshake is a protocol process that establishes the parameters for secure communication between systems. The handshake process involves the exchange of messages to acknowledge each other, the \acrshort{tls} version,  negotiate the cipher suites, authentication with the public key and session keys generation. Besides, there are parameters like message size and timestamp. \acrshort{tls} negotiations are transmitted in plaintext. With the information available through this negotiation, it is possible to fingerprint the client and server applications.  The handshakes also determine the cipher suites proposed by the target system. This information can be leveraged to find vulnerabilities and to characterize the systems based on limited choice of ciphers. The handshake process provides information about the server system that can be used for fingerprinting. As many honeypots depend on static libraries, careful comparison of the actual and the target system responses can reveal if the target system is a honeypot. 
JA3 and JA3s are techniques developed that can actively fingerprint the \acrshort{tls} client and servers based on their hello messages \cite{JA3}. 

\subsection{\acrfull{dpi}}
\acrfull{dpi}  is a method for analyzing and monitoring network traffic. Using DPI, network packets can be filtered based on the protocol type and the data in packet components. Conventional packet inspection methods examine only the header information for filtering the traffic. DPI is performed at enterprises using layer 6 devices like firewalls or intrusion detection systems. \acrshort{dpi} can help to identify redundant responses received from a machine for fingerprinting purposes. \acrshort{dpi} relies on a repository of existing protocol fingerprints for classification. It is an effective technique used by \acrshort{ids} to filter malicious packets from the production networks. On the contrary, \acrshort{dpi} can be an effective technique to fingerprint honeypots or protocols based on the header and the payload information. Sang et al. proposed a fingerprinting technique based on byte embedding for the classification of network protocols \cite{Sang}. The approach learns the application fingerprints from traffic traces by characterizing the packet payloads with a byte embedding based payload alignment algorithm. However, with open-source libraries and tools like nDPI, it is possible to fingerprint and inspect various protocol services on the honeypot \cite{nDPI}. \acrshort{dpi} requires good knowledge of packet-level communication and networking. It is an advanced probe-based method that requires advanced knowledge for the creation of probes to retrieve specific information from the target system.  


\begin{table}
\begin{tabular}{||c c c c c||} 
 \hline
 Honeypot & Protocol & Language & Library & Updated \\ [0.5ex] 
 \hline
 Kippo  & SSH    & Python &  TwistedConch & May2015 \\ 
 Cowrie & SSH    & Python &  TwistedConch & May2018 \\
 TPwD   & Telnet & C      &  custom       & Feb2016 \\
 MTPoT  & Telnet & Python &  telnetsrv    & Mar2017 \\
 TIoT   & Telnet & Python &  custom       & May2017 \\
 Cowrie & Telnet & Python &  TwistedConch & May2018 \\
 Dionaea& HTTP   & Python &  custom       & Sep2016 \\
 Glastof& HTTP   & Python &  BaseHTTPServer& Oct2016 \\
 Conpot & HTTP   & Python &  BaseHTTPServer& Mar2018 \\ [1ex] 
 \hline
\end{tabular}
\caption{Library references in honeypots}
\label{library}
\end{table}

\subsection{Default Configuration Check}
Applications are setup with setup scripts or by using install media. Often, these media do not prompt the user to change the default settings or configuration before the final installation. This leaves the system running with a default configuration. For example, we have Apache Tomcat Manager instance running on a default installation of Apache Tomcat. The manager provides an interface to manage the web service and the deployments. It is important to configure the tomcat manager or disable if not used. Similarly, devices and applications are running with default configurations on the Internet. With these default configurations, it is easily possible to fingerprint the target system. Honeypots like Kippo, Cowrie, Glastopf, and Conpot are usually deployed with default configurations. Morishita et al.  provides an approach to self-revealing honeypots on the Internet by detection through default configurations \cite{morishita}.  Checkpot, a tool developed by the Honeynet Project checks for the configuration errors on a honeypot \cite{Checkpot}. The tool provides tests that probe target machines for Conpot, Cowrie, Dionaea, Glastopf and Kippo. Using Checkpot, the target machines can be checked for default configuration of honeypots. If the response matches the defaults, the end systems is likely a honeypot.

\subsection{System information}
Systems often reveal or allow to be queried about specific information like the processor family, architecture, network interface and timezone. This specific information help in the inference of a honeypot system. They are useful metadata when combined with data collected from other techniques.  Also, ping response times can be used to detect the operating system of the target system. Early works from Mukkamala et al.  show the detection of low-interaction honeypots and virtual environments based on support vector machine models \cite{mukkamala}. The approach compares the average time taken for responses from a virtual machine than that of a real system. The authors determine the existence of a honeypot by testing the limitations of the services emulated by the honeypot, timing analysis of the ICMP echo requests and TCP/\acrshort{ip} fingerprinting with 49 featured data set.  

\subsection{Network Sniffing}
Network Sniffing is a reconnaissance method used for analyzing the network traffic exchanged between two entities. The traffic is monitored to find anomalies. Any deviation from regular behavior, such as redundant network traffic, broadcasts, new hosts in the network and logging help gaining information about the environment. Network sniffing scripts can be deployed on the target systems to extract network information of the system and relay the information to the probing server. The information can be further used to detect honeynets and more honeypot hosts in the network.  Network sniffers can be deployed on the target systems as bots and have information transmitted to a \acrfull{cac} server. 

\subsection{\acrfull{msa}}
\acrlong{msa} can be defined as a sequential array of exploits by an attacker targeting multiple vulnerable services on a system. \acrshort{msa} leverage the vulnerable service on the system to exploit the other services on the same system by gaining more control over the system. These kinds of attacks are key to detection as they help in inferring a relationship between multiple services running on the system that constitutes an environment. Vasilomanolakis et al. proposed a honeypot capable of identifying multi-stage attacks  \cite{vasilomanolakis}. The honeypot is capable of simulating environments by running related services. The honeypot effectively captures advanced persistent threats. However, the information about services running on a system can also infer that the system is not real. For example, in the case of \acrshort{ics}, the communication protocols are active on specific devices and not on a single device. Honeypots like Conpot that are based on \acrshort{ics} show that all the services are running on the target machine. Hence, it can be easily inferred that the target system is a honeypot. 

\subsection{Library Dependency}
Honeypots simulate network protocols. The simulations are usually implemented using pre-built language-specific libraries of protocols that are open-source \cite{Vetterl2018}. Many of the referenced libraries are very old and not maintained. Developers often reference libraries in their project to save time building the library themselves. These libraries are not developed to fully emulate network protocols. They offer basic communication features with some hardcoded response strings. Popular open-source honeypots binaries are available on the Internet. By carefully observing the source code, or the referenced libraries, it is possible to create probes that trigger the static response from the referenced library. For example, the Twisted Conch  library is the most referenced library for SSH protocol simulations in honeypot implementations\cite{twisted}  \cite{counting} . Though there have been recent contributions to the library, there is no change or update made on the honeypots referencing it. Since the library is available as open-source, it can be analyzed for its simulations and static responses can be detected for specially developed probes. The Twisted Conch library also includes simulation for the Telnet protocol. 

Dependency based detection is an effective method for detecting honeypots based on SSH, HTTP, Telnet, FTP, and MODBUS protocols because of their dependency to static libraries. Many honeypots refer to static libraries and this causes static response for carefully crafted requests.There are limited libraries available for the simulation of the above protocols. The honeypots are not updated and still use static responses emulated by the libraries. Table \ref{library}  shows the list of libraries referenced by popular honeypots, protocols, and their versions \cite{Vetterl2018}. By crafting response request, is possible to get static responses or invalid responses that differ from the actual system. By probing the target systems with such requests, it is possible to determine if the target system is a honeypot.  
